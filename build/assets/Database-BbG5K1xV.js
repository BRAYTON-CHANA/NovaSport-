import{u as k,r as u,i as p,j as e,n as w,b as R,o as D,N as O,l as T,m as B,q as S,s as E}from"./index-g1PumTm4.js";import{S as G,H as L}from"./Header-HN8A8OWr.js";import{G as _}from"./GestionInstalacionesModal-D1O17sLp.js";import{G as F}from"./GestionCodigosModal-D5Hp2JG-.js";const M=({isVisible:r,onClose:l})=>{const{database:n,agregarRegistro:d,actualizarRegistro:o,eliminarRegistro:b}=k(),[t,m]=u.useState({Codigo:"",Categoria:"",Subcategoria:""}),[x,h]=u.useState(null),N=n[p]||[];u.useEffect(()=>{r||(m({Codigo:"",Categoria:"",Subcategoria:""}),h(null))},[r]);const C=s=>{const{name:c,value:g}=s.target;m(a=>({...a,[c]:g}))},y=s=>{h(s.id),m({Codigo:s.Codigo,Categoria:s.Categoria,Subcategoria:s.Subcategoria})},f=()=>{h(null),m({Codigo:"",Categoria:"",Subcategoria:""})},H=async s=>{s.preventDefault();const{Codigo:c,Categoria:g,Subcategoria:a}=t;if(!c.trim()||!g.trim()||!a.trim()){alert("Todos los campos son obligatorios.");return}try{if(N.some(j=>j.Codigo.toLowerCase()===c.trim().toLowerCase()&&j.Categoria.toLowerCase()===g.trim().toLowerCase()&&j.Subcategoria.toLowerCase()===a.trim().toLowerCase()&&j.id!==x)){alert("Ya existe una cuenta contable con estos datos.");return}const I={Codigo:c.trim(),Categoria:g.trim(),Subcategoria:a.trim()};x?await o(p,x,I):await d(p,I),f()}catch(A){console.error("Error al guardar la cuenta contable:",A),alert("Ocurrió un error al guardar.")}},v=async s=>{if(window.confirm("¿Está seguro de que desea eliminar esta cuenta contable?"))try{await b(p,s)}catch(c){console.error("Error al eliminar la cuenta contable:",c),alert("Ocurrió un error al eliminar.")}};return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl p-6 w-full max-w-3xl",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-gray-100 border-b pb-2",children:"Gestionar Cuentas Contables"}),e.jsxs("form",{onSubmit:H,className:"mb-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("input",{name:"Codigo",value:t.Codigo,onChange:C,placeholder:"Código",className:"form-input w-full dark:bg-gray-700"}),e.jsx("input",{name:"Categoria",value:t.Categoria,onChange:C,placeholder:"Categoría",className:"form-input w-full dark:bg-gray-700"}),e.jsx("input",{name:"Subcategoria",value:t.Subcategoria,onChange:C,placeholder:"Subcategoría",className:"form-input w-full dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[x&&e.jsx("button",{type:"button",onClick:f,className:"btn border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-100",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn bg-indigo-500 hover:bg-indigo-600 text-white",children:x?"Actualizar":"Añadir"})]})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto pr-2",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:N.map(s=>e.jsxs("li",{className:"py-2 grid grid-cols-4 gap-4 items-center",children:[e.jsx("span",{className:"dark:text-gray-300 col-span-1",children:s.Codigo}),e.jsx("span",{className:"dark:text-gray-300 col-span-1",children:s.Categoria}),e.jsx("span",{className:"dark:text-gray-300 col-span-1",children:s.Subcategoria}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>y(s),className:"text-sm font-medium text-indigo-500 hover:text-indigo-700",children:"Editar"}),e.jsx("button",{onClick:()=>v(s.id),className:"text-sm font-medium text-red-500 hover:text-red-700",children:"Eliminar"})]})]},s.id))})}),e.jsx("div",{className:"flex justify-end mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("button",{onClick:l,className:"btn bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100",children:"Cerrar"})})]})}):null},i=({titulo:r,data:l,columnas:n,onGestionar:d})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-sm border border-gray-200 dark:border-gray-700 p-5 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:r}),d&&e.jsx("button",{onClick:d,className:"btn bg-indigo-500 hover:bg-indigo-600 text-white text-sm py-1 px-3 rounded",children:"Gestionar"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-gray-500 bg-gray-50 dark:bg-gray-700 dark:bg-opacity-50",children:e.jsx("tr",{children:n.map(o=>e.jsx("th",{className:"p-2 whitespace-nowrap",children:o.Header},o.Header))})}),e.jsx("tbody",{className:"text-sm divide-y divide-gray-100 dark:divide-gray-700",children:l&&l.length>0?l.map((o,b)=>e.jsx("tr",{children:n.map(t=>e.jsx("td",{className:`p-2 whitespace-nowrap ${t.className||""}`,children:t.Cell?t.Cell({item:o}):o[t.accessor]},t.accessor))},o.id||b)):e.jsx("tr",{children:e.jsx("td",{colSpan:n.length,className:"p-4 text-center text-sm text-slate-500",children:"No hay datos registrados en esta tabla."})})})]})})]});function V(){const{database:r,isLoading:l}=k(),[n,d]=u.useState(!1),[o,b]=u.useState(!1),[t,m]=u.useState(!1),[x,h]=u.useState(!1);if(l||!r)return e.jsx("div",{children:"Cargando base de datos..."});const N=[{Header:"ID",accessor:"id",className:"text-center font-bold"},{Header:"Tipo",accessor:"Tipo",Cell:({item:a})=>e.jsx("span",{className:`font-semibold ${a.Tipo==="GARANTIA"?"text-sky-500":a.Tipo==="ANULADO"?"text-rose-500":"text-slate-800 dark:text-slate-100"}`,children:a.Tipo})},{Header:"N° Referencia",accessor:"NroReferencia"}],C=[{Header:"ID",accessor:"id",className:"text-center"},{Header:"N° Recibo",accessor:"NroRecibo"},{Header:"N° Documento",accessor:"NroDocumento"},{Header:"Tipo Doc.",accessor:"Documento"},{Header:"Fecha",accessor:"Fecha"},{Header:"Alquilado A",accessor:"AlquiladoA"},{Header:"Instalación",accessor:"Instalacion"},{Header:"Categoría",accessor:"Categoria"},{Header:"Subcategoría",accessor:"Subcategoria"},{Header:"Cta. Corriente",accessor:"CuentaCorriente"},{Header:"Importe Total",accessor:"Importe",Cell:({item:a})=>`S/ ${a.Importe.toFixed(2)}`,className:"text-right font-semibold text-emerald-500"},{Header:"Anulado",accessor:"Anulado",Cell:({item:a})=>a.Anulado?"Sí":"No",className:"text-center"}],y=[{Header:"ID",accessor:"id",className:"text-center"},{Header:"Boleta ID Asoc.",accessor:"boletaFacturaId",className:"text-center"},{Header:"Dirigido A",accessor:"dirigidoA"},{Header:"Cta. Corriente",accessor:"cuentaCorriente"},{Header:"Descripción",accessor:"descripcion"},{Header:"Monto Garantía",accessor:"montoGarantia",Cell:({item:a})=>`S/ ${a.montoGarantia.toFixed(2)}`,className:"text-right font-semibold text-sky-500"}],f=[{Header:"ID",accessor:"id",className:"text-center"},{Header:"N° Referencia",accessor:"NroReferencia"},{Header:"Fecha",accessor:"Fecha"},{Header:"Importe",accessor:"Importe",Cell:({item:a})=>`S/ ${a.Importe.toFixed(2)}`,className:"text-right font-semibold text-green-500"},{Header:"Vínculo",accessor:"vinculo",Cell:({item:a})=>a.boletaFacturaId?`Boleta ID: ${a.boletaFacturaId}`:`Garantía ID: ${a.garantiaId}`}],H=[{Header:"ID",accessor:"id"},{Header:"Nombre Evento",accessor:"nombreEvento"},{Header:"Instalación",accessor:"instalacion"},{Header:"Solicitante",accessor:"nombreSolicitante"},{Header:"DNI/RUC",accessor:"dniRuc"},{Header:"Teléfono",accessor:"telefono"}],v=[{Header:"ID",accessor:"id"},{Header:"Evento ID Asoc.",accessor:"eventoId"},{Header:"Espacio Deportivo",accessor:"espacioDeportivo"},{Header:"Fecha",accessor:"fecha"},{Header:"Hora Inicio",accessor:"horaInicio"},{Header:"Hora Fin",accessor:"horaFin"}],s=[{Header:"ID",accessor:"id"},{Header:"Nombre",accessor:"nombre"}],c=[{Header:"ID",accessor:"id"},{Header:"Prefijo",accessor:"prefijo"},{Header:"Ciudad",accessor:"ciudad"}],g=[{Header:"ID",accessor:"id"},{Header:"Código",accessor:"Codigo"},{Header:"Categoría",accessor:"Categoria"},{Header:"Subcategoría",accessor:"Subcategoria"}];return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(G,{sidebarOpen:n,setSidebarOpen:d}),e.jsxs("div",{className:"relative flex flex-col flex-1 overflow-y-auto overflow-x-hidden",children:[e.jsx(L,{sidebarOpen:n,setSidebarOpen:d}),e.jsx("main",{className:"grow",children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto",children:[e.jsx("div",{className:"sm:flex sm:justify-between sm:items-center mb-8",children:e.jsx("h1",{className:"text-2xl md:text-3xl text-gray-800 dark:text-gray-100 font-bold",children:"Visor General de la Base de Datos"})}),e.jsx("h2",{className:"text-xl md:text-2xl text-gray-800 dark:text-gray-100 font-bold mb-4",children:"Datos Financieros"}),e.jsx(i,{titulo:"1. Libro Mayor de Recibos",data:r[w],columnas:N}),e.jsx(i,{titulo:"2. Boletas y Facturas",data:r[R],columnas:C}),e.jsx(i,{titulo:"3. Garantías",data:r[D],columnas:y}),e.jsx(i,{titulo:"4. Referencias de Pago",data:r[O],columnas:f}),e.jsx("hr",{className:"my-8 border-slate-200 dark:border-slate-700"}),e.jsx("h2",{className:"text-xl md:text-2xl text-gray-800 dark:text-gray-100 font-bold mb-4",children:"Datos de Eventos"}),e.jsx(i,{titulo:"Eventos Registrados",data:r[T],columnas:H}),e.jsx(i,{titulo:"Horarios de Eventos",data:r[B],columnas:v}),e.jsx("hr",{className:"my-8 border-slate-200 dark:border-slate-700"}),e.jsx("h2",{className:"text-xl md:text-2xl text-gray-800 dark:text-gray-100 font-bold mb-4",children:"Configuración General"}),e.jsx(i,{titulo:"Instalaciones",data:r[S],columnas:s,onGestionar:()=>b(!0)}),e.jsx(i,{titulo:"Códigos de Documento",data:r[E],columnas:c,onGestionar:()=>m(!0)}),e.jsx(i,{titulo:"Plan de Cuentas Contables",data:r[p],columnas:g,onGestionar:()=>h(!0)})]})})]}),e.jsx(_,{isVisible:o,onClose:()=>b(!1),instalaciones:r[S]}),e.jsx(F,{isVisible:t,onClose:()=>m(!1),codigos:r[E]}),e.jsx(M,{isVisible:x,onClose:()=>h(!1)})]})}export{V as default};
