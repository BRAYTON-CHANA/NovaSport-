const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./exceljs.min-Dfr7M9fq.js","./index-g1PumTm4.js","./index-QmUDQxYG.css"])))=>i.map(i=>d[i]);
import{r as u,j as e,_ as V}from"./index-g1PumTm4.js";import{S as F,H as J}from"./Header-HN8A8OWr.js";function W(){const[j,y]=u.useState(!1),[C,v]=u.useState([]),[c,h]=u.useState(!1),k=i=>{const n=i.target.files[0];if(!n)return;h(!0),v([]);const t=new FileReader;t.onerror=r=>{console.error("FileReader Error:",r),h(!1)},t.onload=async r=>{try{const l=await V(()=>import("./exceljs.min-Dfr7M9fq.js").then(a=>a.e),__vite__mapDeps([0,1,2]),import.meta.url),o=r.target.result,d=new l.default.Workbook;await d.xlsx.load(o);const x=[];d.eachSheet((a,H)=>{const f=[];a.getTables().forEach(w=>{const N=JSON.parse(JSON.stringify(w.getColumn())).table.table.tableRef;if(N){const m=[],g=N.split(":"),p=g[0],S=g.length>1?g[1]:p,O=a.getCell(p).row,_=a.getCell(S).row,A=a.getCell(p).col,D=a.getCell(S).col;a.eachRow({includeEmpty:!0},(P,E)=>{if(E>=O&&E<=_){const R=[];for(let b=A;b<=D;b++){let s=P.getCell(b).value;s!==null&&typeof s=="object"&&(s.result!==void 0?s=s.result:s.richText&&(s=s.richText.map(T=>T.text).join(""))),s==null?s="":typeof s=="boolean"&&(s=s?"VERDADERO":"FALSO"),R.push(String(s))}m.push(R)}}),m.length>0&&f.push({name:w.name,headers:m[0],rows:m.slice(1)})}}),f.length>0&&x.push({sheetName:a.name,tables:f})}),v(x)}catch(l){console.error("Processing Error with ExcelJS:",l)}finally{h(!1)}},t.readAsArrayBuffer(n)};return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(F,{sidebarOpen:j,setSidebarOpen:y}),e.jsxs("div",{className:"relative flex flex-col flex-1 overflow-y-auto overflow-x-hidden",children:[e.jsx(J,{sidebarOpen:j,setSidebarOpen:y}),e.jsx("main",{className:"grow",children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto",children:[e.jsxs("div",{className:"sm:flex sm:justify-between sm:items-center mb-8",children:[e.jsx("div",{className:"mb-4 sm:mb-0",children:e.jsx("h1",{className:"text-2xl md:text-3xl text-gray-800 dark:text-gray-100 font-bold",children:"Visor de Tablas Excel"})}),e.jsx("div",{className:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2",children:e.jsxs("label",{className:`btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white cursor-pointer ${c?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{children:c?"Procesando...":"Subir Archivo Excel"}),e.jsx("input",{type:"file",accept:".xlsx, .xlsm",onChange:k,disabled:c,className:"hidden"})]})})]}),c&&e.jsx("div",{className:"text-center p-8",children:"Analizando archivo, por favor espera..."}),e.jsx("div",{className:"space-y-8",children:C.map((i,n)=>e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:["Hoja: ",i.sheetName]}),i.tables.map((t,r)=>e.jsxs("div",{className:"mt-6 bg-white dark:bg-gray-800 shadow-lg rounded-sm border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4",children:["Tabla: ",t.name]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-gray-400 dark:text-gray-500 bg-gray-50 dark:bg-gray-700 dark:bg-opacity-50",children:e.jsx("tr",{children:t.headers.map((l,o)=>e.jsx("th",{className:"p-2 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:l})},o))})}),e.jsx("tbody",{className:"text-sm divide-y divide-gray-100 dark:divide-gray-700",children:t.rows.map((l,o)=>e.jsx("tr",{children:l.map((d,x)=>e.jsx("td",{className:"p-2 whitespace-nowrap",children:e.jsx("div",{className:"text-left",children:d})},x))},o))})]})})]},r))]},n))})]})})]})]})}export{W as default};
